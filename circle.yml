# This is the CircleCI.com configuration file to enable CI tests
# It installs Lua, LuaRocks and LuaFileSystem on the CI worker, then downloads the Gallery plugin and the AutoAPI descriptions
# Finally it runs the Checker on the Gallery plugin, and on the internal MinimalPlugin test

dependencies:
 pre:
  - sudo apt-get install lua5.1 luarocks
  - sudo luarocks install luafilesystem
  - mkdir ~/Gallery
  - wget -O ~/gallery.zip https://github.com/cuberite/gallery/archive/master.zip
  - unzip -j -d ~/Gallery ~/gallery.zip
  - mkdir ~/AutoAPI
  - wget -O ~/AutoAPI.tgz http://cuberite.xoft.cz/AutoAPI.tgz
  - tar xzf ~/AutoAPI.tgz -C ~/AutoAPI

test:
 override:
  - lua CuberitePluginChecker.lua -p tests/MinimalPlugin -a tests/DummyApiDesc
  - lua CuberitePluginChecker.lua -p ~/Gallery -a ~/AutoAPI -e ManualAPI.lua
